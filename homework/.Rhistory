parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 47, 50),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 39,
xend = 1.45, yend = 49),
arrow = arrow(length = unit(0.5, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 47, 50),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 39,
xend = 1.45, yend = 49),
arrow = arrow(length = unit(0.3, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 50, 47),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 39,
xend = 1.45, yend = 49),
arrow = arrow(length = unit(0.3, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 50, 47),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 39,
xend = 1.45, yend = 50),
arrow = arrow(length = unit(0.3, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 50, 47),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 39,
xend = 1.45, yend = 50),
arrow = arrow(length = unit(0.3, "cm"))) +
geom_segment(aes(x = 2.45, y = 39,
xend = 1.45, yend = 47),
arrow = arrow(length = unit(0.3, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 50, 47),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 39,
xend = 1.45, yend = 50),
arrow = arrow(length = unit(0.3, "cm"))) +
geom_segment(aes(x = 2.45, y = 39,
xend = 2.45, yend = 47),
arrow = arrow(length = unit(0.3, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 50, 47),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 38,
xend = 1.45, yend = 50),
arrow = arrow(length = unit(0.3, "cm"))) +
geom_segment(aes(x = 2.45, y = 39,
xend = 2.45, yend = 47),
arrow = arrow(length = unit(0.3, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 50, 47),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 38,
xend = 1.45, yend = 50),
arrow = arrow(length = unit(0.3, "cm"))) +
geom_segment(aes(x = 2.45, y = 38,
xend = 2.45, yend = 47),
arrow = arrow(length = unit(0.3, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7)
penguins_no_nas %>%
ggplot(aes(x = species, y = bill_length_mm)) +
geom_jitter(alpha = 0) +
theme_classic() +
geom_segment(aes(x = 0.6, y = 38, xend = 1.4, yend = 38), lwd=1.5, color="blue") +
geom_segment(aes(x = 1.6, y = 50, xend = 2.4, yend = 50), lwd=1.5, color="blue") +
geom_segment(aes(x = 2.6, y = 47, xend = 3.4, yend = 47), lwd=1.5, color="blue") +
labs(x = "Species",
y = "Bill length (mm)") +
theme(text = element_text(size = 20)) +
theme(axis.title.y = element_blank()) +
scale_y_continuous(breaks = c(38, 50, 47),
labels = c(TeX("$\\beta_0"),
TeX("$\\beta_0 + \\beta_1"),
TeX("$\\beta_0 + \\beta_2"))) +
geom_segment(aes(x = 1.45, y = 38,
xend = 1.45, yend = 50),
arrow = arrow(length = unit(0.3, "cm"))) +
geom_segment(aes(x = 2.45, y = 38,
xend = 2.45, yend = 47),
arrow = arrow(length = unit(0.3, "cm"))) +
annotate("text", x = 1.3, y = 44,
label = TeX("$\\beta_1", output='character'),
parse=TRUE, size = 7) +
annotate("text", x = 2.3, y = 43,
label = TeX("$\\beta_2", output='character'),
parse=TRUE, size = 7)
blah
summary(blah)
blah <- lm(bill_length_mm ~ species, data = penguins_no_nas)
summary(blah)
dim(penguins_no_nas)
dim(penguins)
38.82 + 8.74
lm(bill_length_mm ~ species, data = penguins_no_nas)
penguin_lm <- lm(bill_length_mm ~ species,
data = penguins_no_nas)
penguins_no_nas %>%
mutate(resids = residuals(penguin_lm)) %>%
ggplot(aes(x = species, y = resids)) +
geom_boxplot() +
theme_bw() +
labs(x = "Species",
y = "Residuals") +
theme(text = element_text(size = 20))
penguins_no_nas %>%
mutate(resids = residuals(penguin_lm)) %>%
group_by(species) %>%
summarize(residual_std_dev = sd(resids))
penguins_no_nas %>%
mutate(resids = residuals(penguin_lm)) %>%
group_by(species) %>%
summarize(residual_std_dev = sd(resids)) %>% kable()
penguins_no_nas %>%
mutate(resids = residuals(penguin_lm)) %>%
ggplot(aes(sample = resids)) +
geom_qq() +
geom_qq_line() +
theme_bw()
drosophila <- read_csv("https://sta112-f21.github.io/homework/drosophila.csv")
View(drosophila)
drosophila %>%
ggplot(aes(x = Diet, y = Mass)) +
geom_boxplot()
drosophila %>%
ggplot(aes(x = Diet, y = Mass)) +
geom_boxplot() +
theme_bw() +
theme(text = element_text(size = 20))
drosophila_lm <- lm(Mass ~ Diet, data = drosophila)
summary(drosophila_lm)
diet_lm <- lm(Mass ~ Diet, data = drosophila)
summary(diet_lm)
drosophila %>%
group_by(Diet) %>%
summarize(mean_mass = mean(Mass))
summary(diet_lm)
nrow(drosophila)
1372 - 3
drosophila %>%
mutate(resids = residuals(diet_lm)) %>%
ggplot(aes(x = Diet, y = resids)) +
geom_boxplot() +
theme_bw() +
labs(x = "Species",
y = "Residuals") +
theme(text = element_text(size = 20))
drosophila %>%
mutate(resids = residuals(penguin_lm)) %>%
group_by(Diet) %>%
summarize(residual_std_dev = sd(resids))
drosophila %>%
mutate(resids = residuals(diet_lm)) %>%
group_by(Diet) %>%
summarize(residual_std_dev = sd(resids))
drosophila %>%
mutate(resids = residuals(diet_lm)) %>%
ggplot(aes(sample = resids)) +
geom_qq() +
geom_qq_line() +
theme_bw() +
labs(x = "Theoretical normal quantiles",
y = "Observed residual quantiles")
length(unique(drosophila$WingLength))
length(unique(drosophila$Mass))
diet_lm <- lm(WingLength ~ Diet, data = drosophila)
drosophila %>%
ggplot(aes(x = Diet, y = WingLength)) +
geom_boxplot() +
theme_bw() +
theme(text = element_text(size = 20))
summary(diet_lm)
1.88 + 0.16
drosophila %>%
group_by(Diet) %>%
summarize(mean_WingLength = mean(WingLength))
drosophila %>%
mutate(resids = residuals(diet_lm)) %>%
ggplot(aes(x = Diet, y = resids)) +
geom_boxplot() +
theme_bw() +
labs(x = "Diet",
y = "Residuals")
drosophila %>%
mutate(resids = residuals(diet_lm)) %>%
group_by(Diet) %>%
summarize(residual_std_dev = sd(resids))
drosophila %>%
mutate(resids = residuals(diet_lm)) %>%
ggplot(aes(sample = resids)) +
geom_qq() +
geom_qq_line() +
theme_bw() +
labs(x = "Theoretical normal quantiles",
y = "Observed residual quantiles")
penguins %>%
drop_na() %>%
ggplot(aes(x = bill_depth_mm,
y = body_mass_g)) +
geom_point() +
labs(x = "Bill depth (mm)",
y = "Body mass (g)",
title = "Body mass vs. bill depth for Palmer penguins") +
theme_bw()
penguins %>%
drop_na() %>%
ggplot(aes(x = bill_depth_mm,
y = body_mass_g,
color = species)) +
geom_point() +
labs(x = "Bill depth (mm)",
y = "Body mass (g)",
color = "Species",
title = "Body mass vs. bill depth for Palmer penguins") +
theme_bw()
gentoos <- penguins %>%
drop_na() %>%
filter(species == "Gentoo")
gentoos %>%
summarize(r = cor(bill_depth_mm, body_mass_g))
lm(body_mass_g ~ bill_depth_mm, data = gentoos)
penguins %>%
drop_na() %>%
ggplot(aes(x = bill_depth_mm,
y = body_mass_g,
color = species)) +
geom_point() +
geom_smooth(method = "lm",
se=F) +
labs(x = "Bill depth (mm)",
y = "Body mass (g)",
color = "Species",
title = "Body mass vs. bill depth for Palmer penguins") +
theme_bw()
lm(body_mass_g ~ bill_depth_mm, data = penguins %>% filter(species == "Adelie"))
?Pines
pines_new %>%
ggplot(aes(x = Diam97,
y = Hgt97)) +
labs(x = "Diameter in 1997 (cm)",
y = "Height in 1997 (cm)",
title = "Height vs. diameter for Kenyon pines in 1997") +
theme_bw()
pines_new %>%
summarize(r = cor(Diam97, Hgt97))
pines_new %>%
ggplot(aes(x = Diam97,
y = Hgt97)) +
geom_point() +
labs(x = "Diameter in 1997 (cm)",
y = "Height in 1997 (cm)",
title = "Height vs. diameter for Kenyon pines in 1997") +
theme_bw()
pines_new %>%
summarize(r = cor(Diam97, Hgt97))
pines_new %>%
ggplot(aes(x = Diam97,
y = Hgt97)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
labs(x = "Diameter in 1997 (cm)",
y = "Height in 1997 (cm)",
title = "Height vs. diameter for Kenyon pines in 1997") +
theme_bw()
summary(pines_lm)
pines_new %>%
mutate(resids = residuals(pines_lm),
yhat = predict(pines_lm)) %>%
ggplot(aes(x = yhat,
y = resids)) +
geom_point() +
geom_abline(slope = 0, intercept = 0,
lwd = 1.2, color="blue") +
labs(x = "Predicted height (cm)",
y = "Residual",
title = "Residual plot for linear regression of height on diameter in 1997") +
theme_bw()
pines_new %>%
mutate(resids = residuals(pines_lm)) %>%
ggplot(aes(sample = resids)) +
geom_qq() +
geom_qq_line() +
labs(x = "Theoretical normal quantiles",
y = "Observed residual quantiles",
title = "QQ plot for linear regression of height on diameter in 1997") +
theme_bw()
summary(pines_lm)
sd(residuals(pines_lm))
pines_new %>%
mutate(studentized_resids = rstudent(pines_lm),
yhat = predict(pines_lm)) %>%
ggplot(aes(x = yhat, y = studentized_resids)) +
geom_point() +
geom_abline(slope = 0, intercept = 0,
color = "blue", lwd=1.2) +
geom_abline(slope = 0, intercept = c(-3, -2, 2, 3),
color = "orange", lty = 2, lwd=1.2) +
labs(x = "Predicted height in 1997 (cm)",
y = "Studentized residuals") +
theme_bw()
pines_new_2 <- pines_new %>%
mutate(studentized_resids = rstudent(pines_lm)) %>%
filter(studentized_resids != min(studentized_resids))
pines_lm_2 <- lm(Hgt97 ~ Diam97, data = pines_new_2)
pines_transformed <- pines_new %>%
mutate(sqrt_height = sqrt(Hgt97),
sqrt_diameter = sqrt(Diam97))
pines_transformed_lm <- lm(sqrt_height ~ sqrt_diameter,
data = pines_transformed)
pines_transformed %>%
mutate(resids = residuals(pines_transformed_lm),
yhat = predict(pines_transformed_lm)) %>%
ggplot(aes(x = yhat,
y = resids)) +
geom_point() +
geom_abline(slope = 0, intercept = 0,
lwd = 1.2, color="blue") +
labs(x = "Predicted square root height (cm)",
y = "Residual",
title = "Residual plot") +
theme_bw()
pines_transformed <- pines_new %>%
mutate(sqrt_height = log(Hgt97),
sqrt_diameter = sqrt(Diam97))
pines_transformed_lm <- lm(sqrt_height ~ sqrt_diameter,
data = pines_transformed)
pines_transformed %>%
mutate(resids = residuals(pines_transformed_lm),
yhat = predict(pines_transformed_lm)) %>%
ggplot(aes(x = yhat,
y = resids)) +
geom_point() +
geom_abline(slope = 0, intercept = 0,
lwd = 1.2, color="blue") +
labs(x = "Predicted square root height (cm)",
y = "Residual",
title = "Residual plot") +
theme_bw()
pines_transformed <- pines_new %>%
mutate(sqrt_height = log(Hgt97),
sqrt_diameter = log(Diam97))
pines_transformed_lm <- lm(sqrt_height ~ sqrt_diameter,
data = pines_transformed)
pines_transformed %>%
mutate(resids = residuals(pines_transformed_lm),
yhat = predict(pines_transformed_lm)) %>%
ggplot(aes(x = yhat,
y = resids)) +
geom_point() +
geom_abline(slope = 0, intercept = 0,
lwd = 1.2, color="blue") +
labs(x = "Predicted square root height (cm)",
y = "Residual",
title = "Residual plot") +
theme_bw()
pines_transformed %>%
mutate(resids = residuals(pines_transformed_lm)) %>%
ggplot(aes(sample = resids)) +
geom_qq() +
geom_qq_line() +
labs(x = "Theoretical normal quantiles",
y = "Observed residual quantiles",
title = "QQ plot") +
theme_bw()
pines_transformed <- pines_new %>%
mutate(sqrt_height = sqrt(Hgt97),
sqrt_diameter = sqrt(Diam97))
pines_transformed_lm <- lm(sqrt_height ~ sqrt_diameter,
data = pines_transformed)
pines_transformed %>%
mutate(resids = residuals(pines_transformed_lm),
yhat = predict(pines_transformed_lm)) %>%
ggplot(aes(x = yhat,
y = resids)) +
geom_point() +
geom_abline(slope = 0, intercept = 0,
lwd = 1.2, color="blue") +
labs(x = "Predicted square root height (cm)",
y = "Residual",
title = "Residual plot") +
theme_bw()
pines_transformed %>%
mutate(resids = residuals(pines_transformed_lm)) %>%
ggplot(aes(sample = resids)) +
geom_qq() +
geom_qq_line() +
labs(x = "Theoretical normal quantiles",
y = "Observed residual quantiles",
title = "QQ plot") +
theme_bw()
summary(diet_lm)
